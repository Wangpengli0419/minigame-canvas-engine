(()=>{"use strict";var t={684:(t,e,n)=>{const s=n(419),o=r("br,a,code,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),i=r("abbr,acronym,applet,b,basefont,bdo,big,button,cite,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),l=r("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");function r(t){const e={},n=t.split(",");for(let t=0;t<n.length;t++)e[n[t]]=!0;return e}t.exports={html2json:function(t){t=function(t){return(t=(t=t.replace(/\r\n/g,"")).replace(/\n/g,"")).replace(/code/g,"wxxxcode-style")}((t=function(t){return t.replace(/\r?\n+/g,"").replace(/<!--.*?-->/gi,"").replace(/\/\*.*?\*\//gi,"").replace(/[ ]+</gi,"<")}(t=function(t){return t.replace(/<\?xml.*\?>\n/,"").replace(/<.*!doctype.*\>\n/,"").replace(/<.*!DOCTYPE.*\>\n/,"")}(t))).replace(/&nbsp;/g," ").replace(/&quot;/g,"'").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#8226;/g,"â€¢"));const e=[],n={node:"",nodes:[],images:[],imageUrls:[]};let r=0;return s(t,{start(t,s,a){const c={node:"element",tag:t};var d;0===e.length?(c.index=r.toString(),r+=1):(void 0===(d=e[0]).nodes&&(d.nodes=[]),c.index=`${d.index}.${d.nodes.length}`),o[t]?c.tagType="block":i[t]?c.tagType="inline":l[t]&&(c.tagType="closeSelf"),0!==s.length&&(c.attr=s.reduce(((t,e)=>{const{name:n}=e;let{value:s}=e;return"class"==n&&(c.classStr=s),"style"==n&&(c.styleStr=s),s.match(/ /)&&(s=s.split(" ")),t[n]?Array.isArray(t[n])?t[n].push(s):t[n]=[t[n],s]:t[n]=s,t}),{})),a?(void 0===(d=e[0]||n).nodes&&(d.nodes=[]),d.nodes.push(c)):e.unshift(c)},end(t){const s=e.shift();if(s.tag!==t&&console.error("invalid state: mismatch end tag"),"video"===s.tag&&n.source&&(s.attr.src=n.source,delete n.source),0===e.length)n.nodes.push(s);else{const t=e[0];void 0===t.nodes&&(t.nodes=[]),t.nodes.push(s)}},chars(t){const s={node:"text",text:t};if(0===e.length)s.index=r.toString(),r+=1,n.nodes.push(s);else{const t=e[0];void 0===t.nodes&&(t.nodes=[]),s.index=`${t.index}.${t.nodes.length}`,t.nodes.push(s)}},comment(t){}}),n}}},419:t=>{const e=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,n=/^<\/([-A-Za-z0-9_]+)[^>]*>/,s=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,o=d("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),i=d("a,address,code,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),l=d("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),r=d("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),a=d("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),c=d("wxxxcode-style,script,style,view,scroll-view,block");function d(t){const e={},n=t.split(",");for(let t=0;t<n.length;t++)e[n[t]]=!0;return e}t.exports=function(t,d){let f,h,p;const g=[];let u=t;for(g.last=function(){return this[this.length-1]};t;){if(h=!0,g.last()&&c[g.last()])t=t.replace(new RegExp(`([\\s\\S]*?)</${g.last()}[^>]*>`),((t,e)=>(e=e.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),d.chars&&d.chars(e),""))),b(0,g.last());else if(0==t.indexOf("\x3c!--")?(f=t.indexOf("--\x3e"),f>=0&&(d.comment&&d.comment(t.substring(4,f)),t=t.substring(f+3),h=!1)):0==t.indexOf("</")?(p=t.match(n),p&&(t=t.substring(p[0].length),p[0].replace(n,b),h=!1)):0==t.indexOf("<")&&(p=t.match(e),p&&(t=t.substring(p[0].length),p[0].replace(e,x),h=!1)),h){f=t.indexOf("<");let e="";for(;0===f;)e+="<",f=(t=t.substring(1)).indexOf("<");e+=f<0?t:t.substring(0,f),t=f<0?"":t.substring(f),d.chars&&d.chars(e)}if(t==u)throw`Parse Error: ${t}`;u=t}function x(t,e,n,c){if(e=e.toLowerCase(),i[e])for(;g.last()&&l[g.last()];)b(0,g.last());if(r[e]&&g.last()==e&&b(0,e),(c=o[e]||!!c)||g.push(e),d.start){const t=[];n.replace(s,(function(e,n){const s=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:a[n]?n:"";t.push({name:n,value:s,escaped:s.replace(/(^|[^\\])"/g,'$1\\"')})})),d.start&&d.start(e,t,c)}}function b(t,e){if(e)for(e=e.toLowerCase(),n=g.length-1;n>=0&&g[n]!=e;n--);else var n=0;if(n>=0){for(let t=g.length-1;t>=n;t--)d.end&&d.end(g[t]);g.length=n}}b()}}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var i=e[s]={exports:{}};return t[s](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};(()=>{n.r(s),n.d(s,{default:()=>a,getCharWidth:()=>l});var t=n(684),e=n.n(t);const o="sans-serif";let i;const l=(t,e)=>{if(!i){const t="undefined"!=typeof __env?__env.createCanvas():document.createElement("canvas");i=t.getContext("2d")}const{width:n}=i.measureText(t);return n*e/10};function r(t,e){e&&e(t),t.nodes&&t.nodes.forEach((n=>{n.parent=t,r(n,e)}))}const a={install:function(t){class n extends t.Element{constructor(t){const{style:e={},idName:n="",className:s="",dataset:o}=t;super({idName:n,className:s,dataset:o,style:e}),this.innerText="",this.jsonData=null,this.dcs=[],this.textBaseline="top",this.font="",this.textAlign="left",this.fillStyle="#000000"}set text(t){if(t===this.innerText)return;this.innerText=t;const n=e().html2json(this.innerText);this.jsonData=n,this.buildDrawCallFromJsonData(this.jsonData)}get text(){return this.innerText}setStyleForDc(t,e){e["font-weight"]&&(t.fontWeight=e["font-weight"]),e["font-style"]&&(t.fontStyle=e["font-style"]),e.color&&(t.filleStyle=e.color),e["font-size"]&&(t.fontSize=e["font-size"].replace("px","")),e["text-align"]&&(t.textAlign=e["text-align"])}buildDrawCallFromJsonData(t){const{width:e=0,fontSize:n=12}=this.style;let s,o=this.style.lineHeight||16,i=[],a=-1,c=0;function d(){let t={filleStyle:null,fontStyle:null,fontWeight:null,fontSize:null,textAlign:null,text:"",x:0,y:0};return i.push(t),s=t,s.x=c,s.y=o*a,t}r(t,(t=>{var i,r,f;const{tagType:h,tag:p,styleStr:g}=t;"block"===h&&(a+=1,c=0,d()),"strong"===p&&("bold"!==s.fontWeight&&s.text&&(d(),s.fontWeight="bold"),""===s.text&&(s.fontWeight="bold"),t.styleObj||(t.styleObj={}),t.styleObj["font-weight"]="bold");let u={};if(g){if(g.split(";").filter((t=>!!t)).reduce(((t,e)=>{const n=e.split(":");return n.length&&(t[n[0]]=n[1].trim()),t}),u),u){d();let e=t.parent;for(;e;)e.styleObj&&(u=Object.assign({},e.styleObj,u)),e=e.parent;this.setStyleForDc(s,u),t.styleObj=u}}else{let e=t.parent;for(;e;)e.styleObj&&(u=Object.assign({},e.styleObj,u)),e=e.parent;const n=null===(i=t.parent)||void 0===i?void 0:i.nodes.indexOf(t);n>0&&((null===(r=t.parent)||void 0===r?void 0:r.nodes[n-1].styleStr)||"strong"===(null===(f=t.parent)||void 0===f?void 0:f.nodes[n-1].tag))&&d(),this.setStyleForDc(s,u)}if(s&&"block"===h&&s.textAlign)switch(s.textAlign){case"left":default:s.x=0;break;case"right":s.x=e;break;case"center":s.x=e/2}if(u["font-size"]&&Number(u["font-size"].replace("px","")),t.text){s||d();for(let i=0;i<t.text.length;i++){const r=t.text[i],f=l(r,s&&s.fontSize||n);if(c+f>e){a+=1,c=0;let t=s;d(),Object.assign(s,t),s.text="",s.y=o*a,"left"!==s.textAlign&&s.textAlign||(s.x=0)}c+=f,s.text+=r}}})),this.dcs=i,this.style.height=a*o}repaint(){this.render()}destroySelf(){this.root=null}insert(t,e){this.ctx=t,this.toCanvasData(),e&&this.render()}toCanvasData(){const t=this.style||{};this.fontSize=t.fontSize||12,this.textBaseline="top",this.font=`${t.fontWeight||""} ${t.fontSize||12}px ${o}`,this.textAlign=t.textAlign||"left",this.fillStyle=t.color||"#000"}render(){const t=this.ctx;t.save();const e=this.layoutBox,{style:n}=this;t.textBaseline=this.textBaseline,t.font=this.font,t.textAlign=this.textAlign;let s=e.absoluteX,i=e.absoluteY;const{needClip:l,needStroke:r}=this.renderBorder(t);if(l&&t.clip(),n.backgroundColor&&(t.fillStyle=n.backgroundColor,t.fillRect(s,i,e.width,e.height)),n.backgroundImage&&this.backgroundImage&&t.drawImage(this.backgroundImage,s,i,e.width,e.height),r&&t.stroke(),this.dcs&&this.dcs.length){const{fontSize:e=12}=this.style;this.dcs.forEach((n=>{n.text&&(n.fontWeight||n.fontSize||n.filleStyle||n.fontStyle||n.textAlign?(t.save(),n.filleStyle&&(t.fillStyle=n.filleStyle),n.textAlign&&(t.textAlign=n.textAlign),t.font=`${n.fontStyle||""} ${n.fontWeight||""} ${n.fontSize||e}px ${o}`,t.fillText(n.text,s+n.x,i+n.y),t.restore()):t.fillText(n.text,s+n.x,i+n.y))}))}t.restore()}}return t.registerComponent("richtext",n),n},name:"RichText"}})(),module.exports=s})();